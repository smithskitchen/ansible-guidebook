<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>YAML for Ansible: From Basics to Advanced</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            font-family: "Segoe UI", Arial, sans-serif;
            background: #fcfcfd;
            color: #222;
            margin: 0;
            padding: 0 0 50px 0;
        }
        header, footer {
            text-align: center;
            background: #234e70;
            color: #fff;
            padding: 1em 0;
        }
        main {
            max-width: 800px;
            margin: 30px auto;
            background: #fff;
            padding: 2em;
            border-radius: 10px;
            box-shadow: 0 2px 12px 0 rgba(64,64,64,0.09);
        }
        h1, h2, h3 {
            color: #234e70;
        }
        h1 {
            border-bottom: 2px solid #f5f5f5;
            padding-bottom: 0.3em;
            font-size: 2em;
        }
        h2 {
            margin-top: 2em;
            font-size: 1.4em;
            border-left: 4px solid #234e70;
            padding-left: 10px;
        }
        h3 {
            margin-top: 1.2em;
            font-size: 1.15em;
            color: #3d6ba7;
        }
        ul, ol {
            margin: 1em 0 1em 1.5em;
        }
        code, pre {
            background: #f4f7fa;
            border-radius: 5px;
            font-family: "Fira Mono", "Consolas", monospace;
            font-size: 1em;
        }
        pre {
            padding: 1em;
            overflow-x: auto;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 2em 0;
        }
        table th, table td {
            border: 1px solid #e2e6ea;
            padding: 8px 10px;
            text-align: left;
        }
        table th {
            background: #e9f1fc;
        }
        .tip {
            background: #eaffea;
            border-left: 4px solid #4caf50;
            margin: 1.5em 0;
            padding: 1em;
            border-radius: 5px;
        }
        .warn {
            background: #fff5e6;
            border-left: 4px solid #ffc107;
            margin: 1.5em 0;
            padding: 1em;
            border-radius: 5px;
        }
        a {
            color: #234e70;
            text-decoration: underline;
        }
        nav {
            margin-bottom: 2em;
        }
        nav a {
            color: #234e70;
            margin: 0 12px;
        }
    </style>
</head>
<body>
<header>
    <h1>YAML for Ansible<br><span style="font-size:0.7em;">From Basics to Advanced</span></h1>
</header>
<main>
<nav>
    <a href="index.html#module3" title="Back to Book Index">&larr; Book Index</a>
</nav>
    <h2>1. What is YAML?</h2>
    <p>
        <strong>YAML</strong> (<em>YAML Ain’t Markup Language</em>) is a human-friendly data serialization language, popular in configuration files and especially Ansible playbooks. It is indentation-based and emphasizes readability.
    </p>
    <ul>
        <li>Used for lists, dictionaries (key-value pairs), and simple data structures</li>
        <li>Standard for Ansible playbooks, roles, vars, and inventories (YAML format)</li>
        <li>White space (indentation) defines structure, so avoid tabs and use spaces only</li>
    </ul>

    <h2>2. YAML Basics</h2>
    <h3>2.1 Basic Syntax Rules</h3>
    <ul>
        <li>Indent with spaces (never tabs), commonly 2 spaces per level</li>
        <li>Start with <code>---</code> (document start, optional but good practice)</li>
        <li>Use <code>key: value</code> pairs for dictionaries</li>
        <li>Lists are created with dashes <code>-</code></li>
    </ul>
    <div class="tip">
        Indentation = Structure. If you get errors, check your spaces!
    </div>
    <h3>2.2 Simple Example</h3>
    <pre>
---
name: Sample Project
environment: development
hosts:
  - web01
  - web02
admin:
  name: Jane Doe
  email: jane@example.com
    </pre>

    <h2>3. YAML Data Types</h2>
    <table>
        <thead>
            <tr><th>Type</th><th>Example</th></tr>
        </thead>
        <tbody>
            <tr><td>String</td><td><code>greeting: "Hello, world!"</code></td></tr>
            <tr><td>Integer</td><td><code>port: 8080</code></td></tr>
            <tr><td>Boolean</td><td><code>enabled: true</code></td></tr>
            <tr><td>List (Array)</td><td><pre>items:<br>&nbsp; - one<br>&nbsp; - two</pre></td></tr>
            <tr><td>Dictionary (Map)</td><td><pre>web:<br>&nbsp; port: 80<br>&nbsp; path: /var/www</pre></td></tr>
        </tbody>
    </table>

    <h2>4. Lists & Dictionaries (Nesting)</h2>
    <h3>4.1 Simple List</h3>
    <pre>
users:
  - alice
  - bob
  - carol
    </pre>
    <h3>4.2 List of Dictionaries</h3>
    <pre>
users:
  - name: alice
    uid: 1001
  - name: bob
    uid: 1002
    </pre>
    <h3>4.3 Dictionary with Lists</h3>
    <pre>
groups:
  admins:
    - alice
    - bob
  developers:
    - carol
    - dave
    </pre>

    <h2>5. Multi-line Strings</h2>
    <ul>
        <li>Use <b>|</b> for literal multi-line (preserves line breaks)</li>
        <li>Use <b>&gt;</b> for folded style (newlines folded to spaces)</li>
    </ul>
    <pre>
literal_example: |
  Line 1 of text
  Line 2 stays on new line

folded_example: >
  This is all on
  one line when parsed.
    </pre>

    <h2>6. Anchors and Aliases (DRY Principle)</h2>
    <p>
        YAML lets you reuse blocks using anchors (<code>&amp;name</code>) and aliases (<code>*name</code>):
    </p>
    <pre>
defaults: &amp;default_settings
  retries: 5
  timeout: 30

server1:
  <<: *default_settings
  host: web01

server2:
  <<: *default_settings
  host: web02
    </pre>
    <div class="tip">
        This approach works well for playbook variables, especially when you have shared defaults.
    </div>

    <h2>7. Comments</h2>
    <p>Use <code>#</code> for comments:</p>
    <pre>
# This is a comment
user: alice  # Inline comment
    </pre>

    <h2>8. Special Characters and Quoting</h2>
    <ul>
        <li>Use double or single quotes for strings with colons, special characters, or leading 0 numbers.</li>
        <li>Prefer quotes if you're unsure.</li>
    </ul>
    <pre>
example1: "Value with colon: yes"
example2: 'Single-quoted'
example3: "0123"  # Prevents interpreting as octal
    </pre>

    <h2>9. Example: Ansible Playbook in YAML</h2>
    <pre>
---
- name: Install and configure web server
  hosts: webservers
  become: yes
  vars:
    nginx_port: 8080
  tasks:
    - name: Install nginx
      apt:
        name: nginx
        state: present

    - name: Start nginx
      service:
        name: nginx
        state: started

    - name: Add welcome page
      copy:
        dest: /var/www/html/index.html
        content: |
          <h1>Welcome to {{ inventory_hostname }}</h1>
          <p>Running on port {{ nginx_port }}</p>
    </pre>

    <h2>10. YAML Linting & Best Practices</h2>
    <ul>
        <li>Use <a href="http://www.yamllint.com/" target="_blank">YAML Lint</a> or VS Code’s YAML linting plugin to detect issues.</li>
        <li>Stick with 2-space indentation for Ansible.</li>
        <li>Avoid extra spaces and tabs!</li>
        <li>Keep comments to explain logic, especially for complex structures.</li>
    </ul>
    <div class="warn">
        <b>Troubleshooting YAML Errors</b>
        <ul>
            <li>Check indentation first.</li>
            <li>Ensure all lists and key-value pairs are aligned properly.</li>
            <li>Use online tools or <code>yamllint</code> before running your playbook.</li>
        </ul>
    </div>
    <h2>11. References & Learning Links</h2>
    <ul>
        <li><a href="https://yaml.org/spec/1.2/spec.html" target="_blank">YAML Official Specification</a></li>
        <li><a href="https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html" target="_blank">Ansible YAML Syntax Guide</a></li>
        <li><a href="https://www.yamllint.com/" target="_blank">YAMLLint - Online YAML checker</a></li>
    </ul>
</main>
<footer>
    &copy; 2024 Ansible Guidebook &middot; YAML Essentials
</footer>
</body>
</html>